	.IIF NDF S$$YDF , .NLIST

;
; COPYRIGHT (C) 1987, 1989 BY DIGITAL EQUIPMENT CORPORATION
; ALL RIGHTS RESERVED.
;
; THIS SOFTWARE IS FURNISHED UNDER A LICENSE AND MAY BE USED
; OR COPIED ONLY IN ACCORDANCE WITH THE TERMS OF SUCH LICENSE.
;

	.MACRO	LBLDF$	L,B
;
;
; MODIFIED FOR RSX-11M-PLUS V2.0 BY:
;
;	J. A. KASSON
;	J. M. LAWLER
;
; MODIFIED FOR RSX-11M-PLUS V2.1 BY:
;
;	J. GALLANT
;
; MODIFIED FOR RSX-11M-PLUS BY:
;
;	B. S. MCCARTHY
;	D. P. RABAHY
;
; MODIFIED FOR RSX-11M-PLUS V4.1 BY:
;
;	L. M. PETERSON
;
; MODIFIED FOR RSX-11M-PLUS V4.3 BY:
;
;	J. C. FRANZINI	21-APR-89
;		JCF340 -- FIX .ERROR FOR RSX AND VAX-11 RSX
;
;	K. L. NOEL	14-JUN-89
;		KLN132 -- SET REVISION LEVEL FOR LIBRARY D-SPACE RESERVATIONS
;

;+
;
; TASK IMAGE FILE LABEL BLOCK DEFINITIONS
;
; RESIDENT LIBRARY DESCRIPTOR OFFSETS
;
;-

	.ASECT

.=0
R$LNAM:'L'.BLKW	2		; RADIX-50 LIBRARY NAME
R$LSA:'L' .BLKW	1		; LIBRARY STARTING VIRTUAL ADDRESS
R$LHGV:'L'.BLKW	1		; LIBRARY ADDRESS WINDOW 0 BOUND
R$LMXV:'L'.BLKW	1		; LIBRARY HIGH VIRTUAL ADDRESS LIMIT
R$LLDZ:'L'.BLKW	1		; LIBRARY LOAD SIZE (32W BLOCKS)
R$LMXZ:'L'.BLKW	1		; LIBRARY MAX. SIZE (32W BLOCKS)
R$LOFF:'L'.BLKW	1		; LIBRARY OFFSET INTO PARTITION (32W BLOCKS)
R$LWND:'L'.BLKW	1		; NUMBER OF LIBRARY ADDRESS WINDOWS
R$LSEG:'L'.BLKW	1		; SIZE OF LIBRARY SEGMENT DESCRIPTORS
R$LFLG:'L'.BLKW	1		; LIBRARY FLAGS WORD
R$LDAT:'L'.BLKW	3		; LIBRARY CREATION DATE (YR., MO., DAY)
R$LSIZ:'L'.BLKW	0		; LENGTH OF LIBRARY DESCRIPTOR

;
; LIBRARY LIST ENTRY FLAGS
;

LD$ACC='B'100000		; ACCESS INTENT (1=RW, 0=RO)
LD$RSV='B'040000		; APR RESERVATION FLAG (1=APR RESERVED)
LD$CLS='B'020000		; LIBRARY IS PART OF A CLUSTER
LD$SUP='B'000010		; SUPERVISOR MODE LIBRARY (1=YES)
LD$REL='B'000004		; PIC FLAG (1=POSITION INDEPENDANT)
LD$TYP='B'000002		; SHARED REGION IS LIB (=0) OR COMMON (=1)

;
; LABEL BLOCK OFFSETS
;

.=0
L$BTSK:'L'.BLKW	2		; RADIX 50 TASK NAME

;
;		*** NOTE ***
;
; LABEL BLOCK PARAMETERS BETWEEN THIS OFFSET AND THE START OF THE
; TASK LIBRARY DESCRIPTORS MUST BE IDENTICAL IN FORMAT AND CONTENT
; TO A RESIDENT LIBRARY DESCRIPTOR ENTRY.
;

L$BPAR:'L'.BLKW	2		; RADIX 50 PARTITION NAME
L$BSA:'L' .BLKW	1		; TASK STARTING VIRTUAL ADDRESS
L$BHGV:'L'.BLKW	1		; WINDOW 0 VIRTUAL ADDRESS LIMIT
L$BMXV:'L'.BLKW	1		; TASK HIGH VIRTUAL ADDRESS LIMIT
L$BLDZ:'L'.BLKW	1		; TASK LOAD SIZE (32W BLOCKS)
L$BMXZ:'L'.BLKW	1		; TASK MAX. SIZE (32W BLOCKS)
L$BOFF:'L'.BLKW	1		; TASK OFFSET INTO PARTITION (32W BLOCKS)
L$BWND:'L'.BLKB	1		; NUMBER OF TASK WINDOWS (LESS LIBRARIES)
L$BSYS:'L'.BLKB	1		; SYSTEM IDENTIFICATION
L$BSEG:'L'.BLKW	1		; SIZE OF TASK SEGMENT DESCRIPTORS (BYTES)
L$BFLG:'L'.BLKW	1		; TASK FLAGS WORD
L$BDAT:'L'.BLKW	3		; TASK CREATION DATE (YR., MO., DAY)
L$BLIB:'L'.BLKW	<7.*<R$LSIZ/2>>+1 ; RESIDENT LIBRARY ENTRIES
L$BPRI:'L'.BLKW	1		; TASK PRIORITY
L$BXFR:'L'.BLKW	1		; TASK TRANSFER ADDRESS
L$BEXT:'L'.BLKW	1		; TASK EXTEND SIZE (32W BLOCKS)
L$BSGL:'L'.BLKW	1		; RELATIVE BLOCK NUMBER OF SEGMENT LENGTH LIST
L$BHRB:'L'.BLKW	1		; RELATIVE BLOCK NUMBER OF TASK IMAGE HEADER
L$BBLK:'L'.BLKW	1		; NUMBER OF BLOCKS IN LABEL
L$BLUN:'L'.BLKW	1		; NUMBER OF LOGICAL UNITS
L$BROB:'L'.BLKW 1		; RELATIVE BLOCK NUMBER OF R/O TASK IMAGE
L$BROL:'L'.BLKW	1		; R/O LOAD SIZE (32W BLOCKS)
L$BRDL:'L'.BLKW	1		; R/O DATA LOAD SIZE (32W BLOCKS)
L$BHDB:'L'.BLKW	1		; RELATIVE BLOCK NUMBER OF DATA HEADER
L$BDHV:'L'.BLKW	1		; DATA WINDOW 1 HIGH VIRTUAL ADDRESS
L$BDMV:'L'.BLKW	1		; DATA HIGH VIRTUAL ADDRESS
L$BDLZ:'L'.BLKW	1		; DATA LOAD SIZE
L$BDMZ:'L'.BLKW	1		; DATA MAX SIZE
L$BAPR:'L'.BLKW	1		; LIBRARY D-SPACE RESERVATIONS
	.BLKW	<512.-.>/2
L$BASG:'L'.BLKW	0		; START OF DEVICE ASSIGNMENT TABLES

$LBXL='B'<8.*<R$LSIZ>>		; LENGTH OF EXTRA WINDOWS ADDED FOR M+ TASK'S

;
; OFFSETS AT END OF LABEL BLOCK
;

.=772
L$BFL2:'L'.BLKW	1		; SECOND TASK FLAGS WORD
L$BLRL:'L'.BLKW	1		; LABEL BLOCK REVISION NUMBER
L$AME:'L'	.BLKW	1		; MUST ALWAYS BE NULL

; THE FOLLOWING .ERROR DIRECTIVE MUST HAVE A TRAILING SEMICOLON SO THAT WHEN
; THIS MACRO IS INSERTED INTO A MACRO LIBRARY WITH THE /SZ SWITCH, LBR WILL
; NOT STRIP THE ERROR MESSAGE OFF AS A COMMENT.  THE FOLLOWING .MEXIT DIRECTIVE
; IS NEEDED SO THAT IF THE ERROR IS DETECTED, THE MACRO IS NOT REDEFINED TO NULL
; BEFORE PASS 2 (WHICH IS WHEN THE .ERROR IS PRINTED).

	.IIF NE	.-1000,	.ERROR ;DEFINITIONS OVERLAP NEXT LABEL BLOCK ;
	.IIF NE	.-1000,	.MEXIT

;
; DEFINE LABEL BLOCK REVISION NUMBER. THIS SHOULD BE INCREMENTED
; WHENEVER A NEW FIELD IS ADDED TO THE LABEL BLOCK. IT IS
; STRUCTURED WITH MAJOR/MINOR REVISION NUMBERS IN THE HIGH/LOW
; BYTES, RESPECTIVELY. L$BLRL IS VALID ONLY IF TS$NEW IS SET.
; LABEL BLOCKS WITHOUT TS$NEW SET ARE CONSIDERED REVISION 0. THIS
; TURNS OUT HANDY, SINCE WE BELIEVE THEY ALL HAVE ZEROS IN THE
; L$BLRL OFFSET, ANYWAY.
;
; MAJOR	MINOR
;  REV   REV	ADDITIONS
; ----- -----   ---------
;    1     0    IDENT FIELD, SECOND TASK FLAGS WORD
;    1     1	LIBRARY D-SPACE RESERVATIONS
;

LB$REV='B'000401		; MAJOR REVISION LEVEL = 1
				; MINOR REVISION LEVEL = 1

;
; LABEL BLOCK TASK FLAG WORD DEFINITIONS
;

TS$PIC='B'100000		; TASK IS PIC (1=YES)
TS$NHD='B'040000		; NO HEADER IN TASK IMAGE (1=YES)
TS$ACP='B'020000		; TASK IS ANCILLARY CONTROL PROCESSOR (1=YES)
TS$PMD='B'010000		; GENERATE POST-MORTEM DUMP (1=YES)
TS$SLV='B'004000		; TASK IS SLAVEABLE (1=YES)
TS$NSD='B'002000		; NO SEND TO TASK IS PERMITTED (1=YES)
TS$PRV='B'000400		; TASK IS PRIVELEGED (1=YES)
TS$CMP='B'000200		; TASK BUILT IN COMPATIBILITY MODE (1=YES)
TS$CHK='B'000100		; TASK IS CHECKPOINTABLE (0=YES)
TS$RES='B'000040		; TASK HAS RESIDENT OVERLAYS (1=YES)
TS$IOP='B'000020		; PRIVILEGED TASK NOT MAPPED TO I/O PAGE
TS$SUP='B'000010		; TASK LINKED TO A SUPER MODE LIBRARY (1=YES)
TS$XHR='B'000004		; TASK HAS AN EXTERNAL HEADER (1=YES)
TS$NXH='B'000002		; TASK CAN NOT HAVE AN XTRNL HEADER (1=YES)
TS$NEW='B'000001		; LABEL BLOCK USES NEW FORMAT
				; (MEANS L$BLRL DESCRIBES FORMAT)

;
; SECOND TASK FLAGS WORD
;

T2$FMP='B'000002		; TASK USES FAST MAP DIRECTIVE (1=YES)
T2$CLI='B'000001		; TASK IS A CLI (1=YES)

	.PSECT
	.MACRO	LBLDF$	X,Y
	.ENDM
	.ENDM

	.IIF NDF S$$YDF , .LIST
