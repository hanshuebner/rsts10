TITLE	INPLIN,<INPUT ONE TERMINAL LINE>,0A,10-MAY-91,ABC

;
;		COPYRIGHT (c) 1974, 1991 BY
;	DIGITAL EQUIPMENT CORPORATION, MAYNARD, MASS.
;
; THIS SOFTWARE IS FURNISHED UNDER A LICENSE AND MAY BE USED AND  COPIED
; ONLY  IN  ACCORDANCE  WITH  THE  TERMS  OF  SUCH  LICENSE AND WITH THE
; INCLUSION OF THE ABOVE COPYRIGHT NOTICE.  THIS SOFTWARE OR  ANY  OTHER
; COPIES  THEREOF MAY NOT BE PROVIDED OR OTHERWISE MADE AVAILABLE TO ANY
; OTHER PERSON.  NO TITLE TO AND OWNERSHIP OF  THE  SOFTWARE  IS  HEREBY
; TRANSFERRED.
;
; THE INFORMATION IN THIS SOFTWARE IS SUBJECT TO CHANGE  WITHOUT  NOTICE
; AND  SHOULD  NOT  BE  CONSTRUED  AS  A COMMITMENT BY DIGITAL EQUIPMENT
; CORPORATION.
;
; DIGITAL ASSUMES NO RESPONSIBILITY FOR THE USE  OR  RELIABILITY  OF ITS
; SOFTWARE ON EQUIPMENT WHICH IS NOT SUPPLIED BY DIGITAL.
;

;+
; INPLIN - INPUT A LINE FROM THE TERMINAL
;
; CALL:	CALL	INPLIN,R5,<BUFFER>
;
; BACK:	R5 -> BUFFER
;	STRING READ FROM TELETYPE, TERMINATED WITH LF, ESC, OR FF
;	STRING MADE ASCIZ, BUT DELIMITER NOT STRIPPED
;
; NOTE:	NO SIZE CHECKING DONE
;-
.CSECT

.MCALL	.TTYIN

INPLIN::MOV	R0,-(SP)	;SAVE R0
	MOV	R5,-(SP)	;SAVE R5
	MOV	(R5),R5		;R5 -> BUFFER
10$:	.TTYIN			;GET CHARACTER
	MOVB	R0,(R5)+	;SET IT
	CMPB	R0,#12		;LF?
	BEQ	20$
	CMPB	R0,#33		;ESC?
	BEQ	20$
	CMPB	R0,#14		;FF?
	BNE	10$
20$:	CLRB	(R5)		;SET TERMINATOR
	MOV	(SP)+,R5	;RESTORE R5
	MOV	(SP)+,R0	;RESTORE R0
	MOV	(R5)+,(SP)	;RETURN R5 -> BUFFER
	RETURN	R5

.END

