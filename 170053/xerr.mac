	.TITLE	.X.ERR
	.IDENT	/06.03/

;
; COPYRIGHT (c)	1984 BY DIGITAL EQUIPMENT CORPORATION.
; ALL RIGHTS RESERVED.
;
; THIS SOFTWARE IS FURNISHED UNDER A LICENSE AND MAY BE USED
; OR COPIED ONLY IN ACCORDANCE WITH THE TERMS OF SUCH LICENSE.
;
; C.MONIA 24-JUN-74
;
; MODIFIED BY:
;
;	B. S. MCCARTHY	28-MAY-84
;
;		BM308 -- REMOVE DEPENDENCY ON FORTRAN OTS INTERFACE
;
;	B. S. MCCARTHY	10-JUNE-85
;
;		BM350 -- ADDITION OF BOM$ DIRECTIVE TO REPORT ERRORS
;
; MODIFIED BY:
;
;	B. MCCARTHY	14-JUL-86	06.03
;
;		BM371 -- ADD BPT INSTRUCTION AFTER BOM FOR 11M COMPATIBILITY
; COMMON CODE TO ISSUE AN ERROR NOTIFICATION
;
; 			* * *   N O T E   * * *
;
;	THE OTS IS NO LONGER USED. A BOM$ DIRECTIVE IS USED TO REPORT
;	THE ERROR. IF THAT DIRECTIVE FAILS, (SUCH AS AN RSX-11M SYSTEM)
;	A BPT IS ISSUED. THIS HAS THE SIDE EFFECT THAT ALL ERRORS ARE
;	NOW FATAL. THEY WERE ALL DOCUMENTED AS FATAL, ANYWAY.
;
; MACRO LIBRARY CALLS
;
 
	.MCALL	.PICOD,BOM$S,BOMDF$

	BOMDF$			; DEFINE BREAKPOINT OR MESSAGE
				; ABORT CODES
 
.PAGE
.SBTTL	COMMON CODE FOR ERROR HANDLING.
;
;+
; **-.X.ERR-SUBROUTINE TO ISSUE A FORTRAN OTS ERROR MESSAGE
;
; THIS SUBROUTINE IS PART OF THE EXECUTIVE - FORTRAN INTERFACE CALLS.
;
; THIS ROUTINE WILL ISSUE A BOM$ DIRECTIVE TO CAUSE A TASK ABORT (FATAL
; ERROR) AND THE TKTN "EXECUTIVE INTERFACE ERROR" MESSAGE. IF THE SYSTEM
; DOES NOT SUPPORT BOM$, A BPT IS ISSUED INSTEAD.
;
; CALLING SEQUENCE:
;
;	R0:	ERROR NO.(R/H) AND RETURN INDICATOR(SIGN BIT)
;
;	ALL REGISTERS ARE SAVED AND RESTORED.
;
;-
;
; DEFINE FORTRAN ERROR CODES
;
 
	ERRDEF
 
	.PICOD			; PLACE CODE IN PIC I-SPACE PSECT 
.X.ERR::			;
	BOM$S	#S.BFEI,#0	; FATAL ABORT	
		BPT		; FOR SYSTEMS WITHOUT BOM$
 
	.END
